SELECT 
    HISTORY.CAR_ID, 
    (END_DATE - START_DATE) AS DAYS, 
    CAR.CAR_TYPE, 
    CAR.DAILY_FEE 
    
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY HISTORY
LEFT JOIN CAR_RENTAL_COMPANY_CAR CAR ON 1 = 1
AND CAR.CAR_ID = HISTORY.CAR_ID

-- SELECT 
--     A.CAR_ID, 
--     SUM(DAYS)
-- FROM (
--     -- 각각 CAR_ID 중에서 가장 비싼 HISTORY 구하기 
--     SELECT 
--         CAR_ID, 
--         (END_DATE - START_DATE) AS DAYS
--     FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
    
-- ) A
-- GROUP BY A.CAR_ID

